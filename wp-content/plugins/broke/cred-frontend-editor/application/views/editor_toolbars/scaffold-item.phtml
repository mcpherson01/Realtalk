<?php
/**
 * underscore.js template for each item in the dialog to insert a Toolset Form scaffold.
 *
 * @since m2m
 */
?>
<script type="text/html" id="tmpl-cred-editor-scaffold-item">
    <#
    data = _.extend(
        { 
            attributes: {}, 
            options: {}, 
            class: '',
            requiredItem: false, 
            blockedItem: false, 
            autogeneratedItem: false 
        },
        data
    );
    var templateData = {
        containerClassname: 'cred-editor-scaffold-item-container js-cred-editor-scaffold-item-container',
        containerInclude: 'true'
    };
    if ( data.blockedItem ) {
        templateData.containerClassname += ' cred-editor-scaffold-item-container-disabled';
        templateData.containerInclude = 'false';
        if ( _.has( data, 'blockedReason' ) ) {
            templateData.blockedReason = data.blockedReason;
            if ( _.has( data, 'blockedLink' ) ) {
                templateData.blockedReason = '<a href="' + data.blockedLink + '" target="_blank">' + templateData.blockedReason + ' <i class="fa fa-external-link"></i></a>';
            }
        }
    }
    if ( data.autogeneratedItem ) {
        templateData.containerClassname += ' cred-editor-scaffold-item-container-disabled';
        templateData.containerInclude = 'false';
    }
    templateData.containerClassname += ' ' + data.class;
    #>
    <li class="{{templateData.containerClassname}}" 
        data-shortcode="{{data.shortcode}}" 
        data-fieldtype="{{data.fieldType}}" 
        data-label="{{data.label}}" 
        data-attributes="<# print( _.escape( ( JSON.stringify( data.attributes ) ) ) ); #>" 
        data-options="<# print( _.escape( ( JSON.stringify( data.options ) ) ) ); #>" 
        data-include="{{templateData.containerInclude}}"
    >
        <i class="fa fa-arrows cred-editor-scaffold-item-move js-cred-editor-scaffold-item-move" title="<?php echo esc_attr( __( 'Change position', 'wp-cred' ) ); ?>"></i>
        <# if ( data.requiredItem ) { #>
            <i class="fa fa-lock fa-fw cred-editor-scaffold-item-required" title="<?php echo esc_attr( __( 'Required', 'wp-cred' ) ); ?>"></i>
        <# } else if ( data.blockedItem ) { #>
            <i class="fa fa-times fa-fw cred-editor-scaffold-item-blocked" title="<?php echo esc_attr( __( 'Blocked', 'wp-cred' ) ); ?>"></i>
        <# } else if ( data.autogeneratedItem ) { #>
            <i class="fa fa-check-square fa-fw cred-editor-scaffold-item-autogenerated" title="<?php echo esc_attr( __( 'Can be auto-generated', 'wp-cred' ) ); ?>"></i>
        <# } else { #>
            <i class="fa fa-eye fa-fw cred-editor-scaffold-item-include-toggle js-cred-editor-scaffold-item-include-toggle" title="<?php echo esc_attr( __( 'Toggle element', 'wp-cred' ) ); ?>"></i>
        <# } #>
        {{data.label}}
        <# if ( _.has( templateData, 'blockedReason' ) ) { #>
            <span class="cred-editor-scaffold-item-container-disabled-reason">
                {{{templateData.blockedReason}}}
            </span>
        <# } #>
        <# print( data.templates.scaffold.itemOptions( data ) ); #>
    </li>
</script>